{
  "name": "关于如何在LNMP环境下搭建多版本PHP",
  "tagline": "关于如何在LNMP环境下搭建多版本PHP",
  "body": "**linux版本：64位CentOS 6.4**\r\n**Nginx版本：nginx1.8.0+**\r\n**php版本： php7.05 &php5.6.20**\r\n安装第二个版本的PHP\r\n# wget #PHP下载地址\r\n# tar zxvf #php下载文件.tar.gz\r\n# cd #php所在目录下\r\n#./configure --prefix=/usr/local/#文件夹名 \\\r\n--with-curl \\\r\n--with-freetype-dir \\\r\n--with-gd \\\r\n--with-gettext \\\r\n--with-iconv-dir \\\r\n--with-kerberos \\\r\n--with-libdir=lib64 \\\r\n--with-libxml-dir \\\r\n--with-MySQL \\\r\n--with-mysqli \\\r\n--with-openssl \\\r\n--with-pcre-regex \\\r\n--with-pdo-MySQL \\\r\n--with-pdo-sqlite \\\r\n--with-pear \\\r\n--with-png-dir \\\r\n--with-xmlrpc \\\r\n--with-xsl \\\r\n--with-zlib \\\r\n--enable-fpm \\\r\n--enable-bcmath \\\r\n--enable-libxml \\\r\n--enable-inline-optimization \\\r\n--enable-gd-native-ttf \\\r\n--enable-mbregex \\\r\n--enable-mbstring \\\r\n--enable-pcntl \\\r\n--enable-shmop \\\r\n--enable-soap \\\r\n--enable-sockets \\\r\n--enable-sysvsem \\\r\n--enable-xml \\\r\n--enable-zip\r\n# make &&  make install\r\n\r\n修改php-fpm.conf的侦听端口为9001，因为主版本7.05是侦听9000。\r\n#php-fpm.conf下的内容\r\n[php] view plain copy\r\n; Note: This value is mandatory.  \r\nlisten = 127.0.0.1:9001 #\r\n**启动php-fpm**\r\n#  /etc/init.d/php-fpm5.6\r\n\r\n# **配置Nginx**\r\n# **增加一段新的端口8054的配置并指向到9001以及指定目录即可：**\r\nnginx的配置文件nginx.conf在\r\n# cd /usr/local/nginx/conf  下\r\n\r\nserver {\r\n        listen       8054;\r\n        server_name  localhost;\r\n\r\n        location / {\r\n                root    html;\r\n                #root /usr/local/php5;\r\n                try_files $uri $uri/ /index.php?$query_string;\r\n                index   index.html index.htm;\r\n        }\r\n\r\n        error_page   500 502 503 504  /50x.html;\r\n        location = /50x.html {\r\n                root   html;\r\n        }\r\n\r\n        location ~ \\.php$ {\r\n                root             html;\r\n                fastcgi_pass    127.0.0.1:9001;\r\n                fastcgi_index   index.php;\r\n                include         fastcgi_params;\r\n                fastcgi_param   SCRIPT_FILENAME $DOCUMENT_ROOT$fastcgi_script_name;\r\n                                        #/usr/local/php5$fastcgi_script_name;  \r\n        }\r\n\r\n    }\r\n\r\n\r\n**# 下方是完整的nginx.conf的代码**\r\n        #location ~ /\\.ht {\r\n        #    deny  all;\r\n        #}\r\n    }\r\n    server {\r\n        listen       8054;\r\n        server_name  localhost;\r\n\r\n        location / {\r\n                root    html;\r\n                #root /usr/local/php5;\r\n                try_files $uri $uri/ /index.php?$query_string;\r\n                index   index.html index.htm;\r\n        }\r\n\r\n        error_page   500 502 503 504  /50x.html;\r\n        location = /50x.html {\r\n                root   html;\r\n        }\r\n                #root /usr/local/php5;\r\n                try_files $uri $uri/ /index.php?$query_string;\r\n                index   index.html index.htm;\r\n        }\r\n\r\n        error_page   500 502 503 504  /50x.html;\r\n        location = /50x.html {\r\n                root   html;\r\n        }\r\n\r\n        location ~ \\.php$ {\r\n                root             html;\r\n                fastcgi_pass    127.0.0.1:9001;\r\n                fastcgi_index   index.php;\r\n                include         fastcgi_params;\r\n                fastcgi_param   SCRIPT_FILENAME $DOCUMENT_ROOT$fastcgi_script_name;\r\n                                        #/usr/local/php5$fastcgi_script_name;  \r\n        }\r\n\r\n    }\r\n\r\n\r\n    # another virtual host using mix of IP-, name-, and port-based configuration\r\n    #\r\n    #server {\r\n    #    listen       8000;\r\n    #    listen       somename:8080;\r\n    #    server_name  somename  alias  another.alias;\r\n\r\n    #    location / {\r\n    #        root   html;\r\n    #        index  index.html index.htm;\r\n    #    }\r\n    #}\r\n\r\n#user  nobody;\r\nworker_processes  1;\r\n\r\n#error_log  logs/error.log;\r\n#error_log  logs/error.log  notice;\r\n#error_log  logs/error.log  info;\r\n\r\n#pid        logs/nginx.pid;\r\n\r\n\r\nevents {\r\n    worker_connections  1024;\r\n}\r\n\r\n\r\nhttp {\r\n    include       mime.types;\r\n    default_type  application/octet-stream;\r\n\r\n    #log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\r\n    #                  '$status $body_bytes_sent \"$http_referer\" '\r\n    #                  '\"$http_user_agent\" \"$http_x_forwarded_for\"';\r\n\r\n    #access_log  logs/access.log  main;\r\n\r\n    sendfile        on;\r\n    #tcp_nopush     on;\r\n\r\n    #keepalive_timeout  0;\r\n    keepalive_timeout  65;\r\n\r\n    #gzip  on;\r\n\r\n    server {\r\n        listen       80;\r\n        server_name  localhost;\r\n\r\n        #charset koi8-r;\r\n\r\n        #access_log  logs/host.access.log  main;\r\n\r\n        location / {\r\n            root   html;\r\n            try_files $uri $uri/ /index.php?$query_string;\r\n            index  index.html index.htm;\r\n        }\r\n\r\n        #error_page  404              /404.html;\r\n\r\n        # redirect server error pages to the static page /50x.html\r\n        #\r\n        error_page   500 502 503 504  /50x.html;\r\n        location = /50x.html {\r\n            root   html;\r\n        }\r\n\r\n        # proxy the PHP scripts to Apache listening on 127.0.0.1:80\r\n        #\r\n        #location ~ \\.php$ {\r\n        #    proxy_pass   http://127.0.0.1;\r\n        #}\r\n\r\n        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000\r\n        #\r\n        location ~ \\.php$ {\r\n            root           html;\r\n            fastcgi_pass   127.0.0.1:9000;\r\n            fastcgi_index  index.php;\r\n            fastcgi_param  SCRIPT_FILENAME  $DOCUMENT_ROOT$fastcgi_script_name;\r\n            include        fastcgi_params;\r\n        }\r\n\r\n        # deny access to .htaccess files, if Apache's document root\r\n        # concurs with nginx's one\r\n        #\r\n        #location ~ /\\.ht {\r\n        #    deny  all;\r\n        #}\r\n    }\r\n    server {\r\n        listen       8054;\r\n        server_name  localhost;\r\n\r\n        location / {\r\n                root    html;\r\n                #root /usr/local/php5;\r\n                try_files $uri $uri/ /index.php?$query_string;\r\n                index   index.html index.htm;\r\n        }\r\n\r\n        error_page   500 502 503 504  /50x.html;\r\n        location = /50x.html {\r\n                root   html;\r\n        }\r\n\r\n        location ~ \\.php$ {\r\n                root             html;\r\n                fastcgi_pass    127.0.0.1:9001;\r\n                fastcgi_index   index.php;\r\n                include         fastcgi_params;\r\n                fastcgi_param   SCRIPT_FILENAME $DOCUMENT_ROOT$fastcgi_script_name;\r\n                                        #/usr/local/php5$fastcgi_script_name;  \r\n        }\r\n\r\n    }\r\n\r\n\r\n    # another virtual host using mix of IP-, name-, and port-based configuration\r\n    #\r\n    #server {\r\n    #    listen       8000;\r\n    #    listen       somename:8080;\r\n    #    server_name  somename  alias  another.alias;\r\n\r\n    #    location / {\r\n    #        root   html;\r\n    #        index  index.html index.htm;\r\n    #    }\r\n    #}\r\n\r\n\r\n    # HTTPS server\r\n    #\r\n    #server {\r\n    #    listen       443 ssl;\r\n    #    server_name  localhost;\r\n\r\n    #    ssl_certificate      cert.pem;\r\n    #    ssl_certificate_key  cert.key;\r\n\r\n    #    ssl_session_cache    shared:SSL:1m;\r\n    #    ssl_session_timeout  5m;\r\n\r\n    #    ssl_ciphers  HIGH:!aNULL:!MD5;\r\n    #    ssl_prefer_server_ciphers  on;\r\n\r\n    #    location / {\r\n    #        root   html;\r\n    #        index  index.html index.htm;\r\n    #    }\r\n    #}\r\n\r\n}\r\n\r\n\r\n**重启nginx**\r\n**# /usr/local/nginx/sbin/nginx -s reload**\r\n\r\n**注意需要防火墙增加新端口的开启，不然无法访问：**\r\n**防火墙配置**\r\n**注意如果你希望在本地机器例如xp访问虚拟机的网页，如果是centos6需要修改防火墙启动80端口**\r\n**# cd /etc/sysconfig**\r\n**修改iptables文件，或者直接用vim编辑**\r\n**# vim /etc/sysconfig/iptables**\r\n**添加下面一行，打开防火墙80端口:**\r\n**-A INPUT -m state --state NEW -m tcp -p tcp --dport 8054 -j ACCEPT**\r\n**重启防火墙**\r\n**# /etc/init.d/iptables restart**\r\n\r\n测试是否成功，查看phpinfo()\r\n//我是把根目录设置在nginx/html下的，vim a.php，调用phpinfo(),再用http://192.168.2.187/a.php and  http://192.168.2.187:8054/a.php来访问\r\n//(ip请选择自己的，第二个端口我是设置成8054)\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}